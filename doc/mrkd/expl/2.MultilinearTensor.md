
# Multilinear tensor


```julia
using TensorDec
```

We consider a multi-linear tensor of size 3 x 4 x 5, which is sum of tensor products of random vectors, which are the colmuns of the matrices `A0`, `B0`, `C0`with weights `w0`:


```julia
A0 = rand(4,3)
B0 = rand(3,3)
C0 = rand(5,3)
w0 = rand(3)
T0 = tensor(w0, A0, B0, C0)
```




    4×3×5 Array{Float64,3}:
    [:, :, 1] =
     0.159385   0.329923  0.223307 
     0.113206   0.260249  0.144085 
     0.128891   0.270302  0.167978 
     0.0688359  0.188183  0.0720426
    
    [:, :, 2] =
     0.0712152  0.147552  0.0976956
     0.053632   0.126337  0.0654307
     0.0599872  0.127307  0.0768573
     0.0359095  0.101122  0.0353947
    
    [:, :, 3] =
     0.138084   0.289562  0.203655 
     0.0930081  0.211113  0.12687  
     0.101287   0.211877  0.135876 
     0.0518     0.137275  0.0596053
    
    [:, :, 4] =
     0.13036    0.283012  0.203137 
     0.0950733  0.228796  0.131191 
     0.0862976  0.188685  0.11692  
     0.062888   0.176206  0.0698263
    
    [:, :, 5] =
     0.0786642  0.163262  0.106995 
     0.0610696  0.145691  0.0730894
     0.067387   0.143981  0.0856528
     0.0427886  0.122034  0.04114  



We compute its decomposition:


```julia
w, A, B, C = decompose(T0);
```

We obtain a decomposition of rank 3 with weights:


```julia
w
```




    3-element Array{Float64,1}:
     0.297749
     0.73329 
     0.27751 



The 3 vectors of the first component, with norm 1, are the colmuns of the matrix A:  


```julia
A
```




    4×3 Array{Float64,2}:
     0.121546  0.687188  0.828936
     0.521541  0.396037  0.471977
     0.235676  0.595314  0.222841
     0.810973  0.128561  0.201109



The 3 vectors of the second component, with norm 1, are the colmuns of the matrix B: 


```julia
B
```




    3×3 Array{Float64,2}:
     0.285535  -0.389307  -0.312729
     0.935362  -0.764195  -0.728485
     0.208728  -0.514244  -0.609516



The 3 vectors of the third component, with norm 1, are the colmuns of the matrix C: 


```julia
C
```




    5×3 Array{Float64,2}:
     0.560872  -0.651516  -0.358331
     0.329605  -0.299923  -0.124713
     0.356574  -0.49494   -0.51855 
     0.529427  -0.35932   -0.756189
     0.411515  -0.333911  -0.12381 



It corresponds to the tensor `sum(w[i] A[:,i] ° B[:,i] ° C[:,i] for i in 1:r)`:


```julia
T = tensor(w, A, B, C)
```




    4×3×5 Array{Float64,3}:
    [:, :, 1] =
     0.159385   0.329923  0.223307 
     0.113206   0.260249  0.144085 
     0.128891   0.270302  0.167978 
     0.0688359  0.188183  0.0720426
    
    [:, :, 2] =
     0.0712152  0.147552  0.0976956
     0.053632   0.126337  0.0654307
     0.0599872  0.127307  0.0768573
     0.0359095  0.101122  0.0353947
    
    [:, :, 3] =
     0.138084   0.289562  0.203655 
     0.0930081  0.211113  0.12687  
     0.101287   0.211877  0.135876 
     0.0518     0.137275  0.0596053
    
    [:, :, 4] =
     0.13036    0.283012  0.203137 
     0.0950733  0.228796  0.131191 
     0.0862976  0.188685  0.11692  
     0.062888   0.176206  0.0698263
    
    [:, :, 5] =
     0.0786642  0.163262  0.106995 
     0.0610696  0.145691  0.0730894
     0.067387   0.143981  0.0856528
     0.0427886  0.122034  0.04114  



We compute the L2 norm of the difference between T and T0:


```julia
norm(T-T0)
```




    1.46972027008078e-7


