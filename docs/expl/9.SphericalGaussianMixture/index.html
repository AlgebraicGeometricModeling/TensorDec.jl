<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Decomposition of a mixture of spherical Gaussians · TensorDec</title><meta name="title" content="Decomposition of a mixture of spherical Gaussians · TensorDec"/><meta property="og:title" content="Decomposition of a mixture of spherical Gaussians · TensorDec"/><meta property="twitter:title" content="Decomposition of a mixture of spherical Gaussians · TensorDec"/><meta name="description" content="Documentation for TensorDec."/><meta property="og:description" content="Documentation for TensorDec."/><meta property="twitter:description" content="Documentation for TensorDec."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="TensorDec logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TensorDec</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../0.Decomposition/">Decomposition algorithm</a></li><li><a class="tocitem" href="../1.SymmetricTensor/">Symmetric tensors</a></li><li><a class="tocitem" href="../2.MultilinearTensor/">Multilinear tensors</a></li><li><a class="tocitem" href="../7.Phylogenetic/">Phylogenetic trees</a></li><li><a class="tocitem" href="../8.1.Sym_rank_one_approx/">Best rank one approximation and optimization on the sphere</a></li><li><a class="tocitem" href="../8.2.Sym_rank_approx/">Low rank approximation of symmetric tensors</a></li><li class="is-active"><a class="tocitem" href>Decomposition of a mixture of spherical Gaussians</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../code/0.tensors/">Tensors</a></li><li><a class="tocitem" href="../../code/1.series/">Series</a></li><li><a class="tocitem" href="../../code/2.polynomials/">Polynomials</a></li><li><a class="tocitem" href="../../code/3.decompose/">Decomposition</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Decomposition of a mixture of spherical Gaussians</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Decomposition of a mixture of spherical Gaussians</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AlgebraicGeometricModeling/TensorDec.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AlgebraicGeometricModeling/TensorDec.jl/blob/master/docs/src/expl/9.SphericalGaussianMixture.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Decomposition-of-a-mixture-of-spherical-Gaussians"><a class="docs-heading-anchor" href="#Decomposition-of-a-mixture-of-spherical-Gaussians">Decomposition of a mixture of spherical Gaussians</a><a id="Decomposition-of-a-mixture-of-spherical-Gaussians-1"></a><a class="docs-heading-anchor-permalink" href="#Decomposition-of-a-mixture-of-spherical-Gaussians" title="Permalink"></a></h1><p>The idea is to apply the Theorem 1 from <a href="https://arxiv.org/abs/1206.5766">(D. Hsu &amp; S.M. Kakade, 2012)</a> for <span>$r$</span> spherical Gaussian mixture  with differing covariances by using functions from the package TensorDec such that the symmetric low rank approximation functions to find the variances <span>$\sigma_1,...,\sigma_r$</span>, the means <span>$\mu_1,...,\mu_r$</span> and  the weights <span>$w_1,...,w_r$</span>.  We denote by <span>$r$</span> the number of clusters obeying multivariate Gaussian distributions, by <span>$n$</span> the dimension or the number of features, and by <span>$N$</span> the number of vectors i.e., the number of the observations <span>$x_i$</span> in the data set <span>$S$</span>. Note that for the applicability of the theorem <span>$r$</span> should be smaller or equal to <span>$n$</span>.</p><pre><code class="language-julia hljs"># load the packages needed in this example
using TensorDec
using Distributions, GaussianMixtures, LinearAlgebra, Plots</code></pre><pre><code class="language-julia hljs">n = 2 # number of features
r = 2 # number of clusters
N = 1000 # number of observations in the dataset
w_real = [0.3, 0.7] # the cluster proportions, here we have two clusters one contains 30% from the observations and the other cluster contains 70% from the observations.
Mu_real = [[-5.0, -3.0], [-5.0, 4.0]] # the first (resp. the second) cluster obeying multivariate Gaussian distribution of mean [-5.0, -3.0] (resp. [-5.0, 4.0]). 
Sigma_real = [0.4, 0.3]; # the covariance matrix in the first (resp. the second) Gaussian distribution is 0.4*I (resp. 0.3*I) where I is the identity matrix.</code></pre><pre><code class="language-julia hljs"># Randomaly sample a dataset of N points obeying spherical Gaussian mixture according to the parameters w_real, Mu_real and Sigma_real.
Nrm = [MvNormal([Mu_real[i]...,i],Diagonal([ones(n)*Sigma_real[i]...,0]))  for i in 1:r]
Mix_of_Gaussians = MixtureModel(Nrm[1:r],w_real)
S_label = rand(Mix_of_Gaussians, N)</code></pre><pre><code class="nohighlight hljs">3×1000 Array{Float64,2}:
 -6.93469  -5.03918  -5.26152  -5.83157  …  -5.45367  -4.80835  -4.39562
 -3.28932   3.79391   3.29996   4.65434      4.15295  -2.44732  -3.83481
  1.0       2.0       2.0       2.0          2.0       1.0       1.0</code></pre><p>We can notice that we obtain with this code a matrix S_label where the number of columns is the number of the observations equal to N=1000, the last row in this matrix contains the labels of the clusters, for example the first point (-6.93469, -3.28932) is in the cluster 1 the next point is in the cluster 2...etc, this helps us to separate the two clusters using different colors in the plot (see the plot at the end of this notebbok). </p><pre><code class="language-julia hljs"># here we take the dataset without the clusters to apply the method of moments.
S = S_label[1:n,:]</code></pre><pre><code class="nohighlight hljs">2×1000 Array{Float64,2}:
 -6.93469  -5.03918  -5.26152  -5.83157  …  -5.45367  -4.80835  -4.39562
 -3.28932   3.79391   3.29996   4.65434      4.15295  -2.44732  -3.83481</code></pre><pre><code class="language-julia hljs"># the function moments_var_diff applies the method of moments by taking as arguments the dataset S and the number of clusters r and
# returns the estimated weights vector &#39;w_pred&#39;, the means in columns in a matrix &#39;Mu_pred&#39;, and the variances in a vector &#39;Sigma_pred&#39;.    
w_pred, Mu_pred, Sigma_pred = moment_var_diff(S,r)</code></pre><pre><code class="nohighlight hljs">([0.30746190732797457, 0.6925380926720255], [-4.9867727722153905 -4.997716895030157; -2.996896461673346 3.9751432109706357], [0.38691174790834876, 0.30802777553042104])</code></pre><pre><code class="language-julia hljs"># put Mu_pred in the same form as Mu_real.
Mu_pred = [Mu_pred[:,i] for i in 1:r]</code></pre><pre><code class="nohighlight hljs">2-element Array{Array{Float64,1},1}:
 [-4.9867727722153905, -2.996896461673346]
 [-4.997716895030157, 3.9751432109706357]</code></pre><p>Let us look at the real parameters and the estimated parameters obtained by &lt;font color=&#39;red&#39;&gt;moment<em>var</em>diff&lt;/font&gt;. </p><pre><code class="language-julia hljs">print(&quot;w_real: &quot;, w_real, &quot;\n&quot;)
print(&quot;w_pred: &quot;, w_pred)
</code></pre><pre><code class="nohighlight hljs">w_real: [0.3, 0.7]
w_pred: [0.30746190732797457, 0.6925380926720255]</code></pre><pre><code class="language-julia hljs">print(&quot;Mu_real: &quot;, Mu_real, &quot;\n&quot;)
print(&quot;Mu_pred: &quot;, Mu_pred)</code></pre><pre><code class="nohighlight hljs">Mu_real: [[-5.0, -3.0], [-5.0, 4.0]]
Mu_pred: [[-4.9867727722153905, -2.996896461673346], [-4.997716895030157, 3.9751432109706357]]</code></pre><pre><code class="language-julia hljs">print(&quot;Sigma_real: &quot;, Sigma_real, &quot;\n&quot;)
print(&quot;Sigma_pred: &quot;, Sigma_pred)</code></pre><pre><code class="nohighlight hljs">Sigma_real: [0.4, 0.3]
Sigma_pred: [0.38691174790834876, 0.30802777553042104]</code></pre><pre><code class="language-julia hljs"># for the scatter plot we need the matrix form of Mu_real and Mu_pred. 
Mu_real = [-5.0 -5.0
           -3.0  4.0]
Mu_pred = [-4.9867727722153905 -4.997716895030157 
           -2.996896461673346 3.9751432109706357]</code></pre><pre><code class="nohighlight hljs">2×2 Array{Float64,2}:
 -4.98677  -4.99772
 -2.9969    3.97514</code></pre><pre><code class="language-julia hljs">fig = plot(S[1,:],S[2,:], zcolor = S_label[end,:]/r, m = ColorGradient([:pink, :lightblue]), seriestype = :scatter, legend=false, msw = 0, label =&quot;&quot;, fmt=:png)
fig = plot!(Mu_real[1,:], Mu_real[2,:], seriestype = :scatter, m = (:yellow, [:circle], 7),label = &quot;Real_means&quot;, fmt=:png) 
fig = scatter!(Mu_pred[1,:], Mu_pred[2,:], m = (:red, [:star7], 5), label = &quot;Estimated_means&quot;, legend = true)</code></pre><p><img src="../9.SphericalGaussianMixture_files/9.SphericalGaussianMixture_14_0.png" alt="png"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../8.2.Sym_rank_approx/">« Low rank approximation of symmetric tensors</a><a class="docs-footer-nextpage" href="../../code/0.tensors/">Tensors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Tuesday 23 July 2024 15:50">Tuesday 23 July 2024</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
